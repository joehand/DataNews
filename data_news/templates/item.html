{% extends "_base.html" %}
{% import "bootstrap_wtf.html" as wtf %}

{%- block content %}
            <div class="row">
            {% set item_page = True %}
            {% if item.kind == 'post' %}
              {% include "_post.html" %}
            {% elif item.kind == 'comment' %}
              {% include "_comment.html" %}
            {% endif %}
            {% set item_page = False %}
            </div>

            <div class="row comment-form">
            {% if current_user.id %}
              <form class="form form-horizontal" method="post" action="">
                {{ form.hidden_tag() }}
                {{ wtf.form_errors(form, "only") }}

                {{ wtf.comment_field(form.text) }}
                {{ wtf.inline_field(form.kind) }}
                {{ wtf.inline_field(form.parent_id, value=item.id) }}

                <div class="form-group submit">
                  <div class="col-lg-12 col-md-12">
                    <button type="submit" class="btn btn-default btn-xs">submit</button>
                  </div>
                </div>
              </form>
            {% else %}
            <div class="panel panel-default col-lg-12 col-md-12">
              <div class="panel-body">
              <p><a class="alert-link" href="{{url_for("security.login")}}">Login</a> or <a class="alert-link" href="{{url_for("security.register")}}">register</a> to comment.</p>
              </div>
            </div>
            {% endif %}
            </div>

            {%- for comment in item.get_children() -%}
              {% set depth = comment[1] - 1 %}
              {% set comment = comment[0] %}
            <div class="row">
              {% include "_comment.html" %}
            </div>
            {%- endfor %}
{% endblock -%}
